{"pageProps":{"note":{"id":"obuonjuhcj0tlex3qqgzzyg","title":"Intro to LLMs","desc":"","updated":1740001542785,"created":1739407566715,"url":"https://www.youtube.com/watch?v=zjkBMFhNj_g&ab_channel=AndrejKarpathy","custom":{"url":"https://www.youtube.com/watch?v=zjkBMFhNj_g&ab_channel=AndrejKarpathy"},"fname":"ML.AK.Intro to LLMs","type":"note","vault":{"fsPath":".","selfContained":true,"name":"Dendron"},"contentHash":"37ab0a87b633c1c6b234c87f7d647983","links":[{"from":{"fname":"ML.AK","vaultName":"Dendron"},"type":"backlink","position":{"start":{"line":3,"column":42,"offset":115},"end":{"line":3,"column":65,"offset":138},"indent":[]},"value":"ML.AK.Intro to LLMs","alias":"ML.AK.Intro to LLMs"}],"anchors":{"intro-to-llms":{"type":"header","text":"Intro to LLMS","value":"intro-to-llms","line":9,"column":0,"depth":3},"there-are-three-main-parts-of-building-a-model---training-inference-and-fine-tuning":{"type":"header","text":"There are three main parts of building a model - training, inference and fine-tuning.","value":"there-are-three-main-parts-of-building-a-model---training-inference-and-fine-tuning","line":41,"column":0,"depth":3},"how-does-it-work":{"type":"header","text":"How does it work?","value":"how-does-it-work","line":49,"column":0,"depth":3},"fine-tuning":{"type":"header","text":"Fine-Tuning","value":"fine-tuning","line":55,"column":0,"depth":3},"scaling-laws":{"type":"header","text":"Scaling Laws","value":"scaling-laws","line":65,"column":0,"depth":3},"tool-use":{"type":"header","text":"Tool use","value":"tool-use","line":73,"column":0,"depth":3}},"children":[],"parent":"kndcs9cayrizdzefp1veykh","data":{}},"body":"<h1 id=\"intro-to-llms\"><a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#intro-to-llms\"></a>Intro to LLMs</h1>\n<h3 id=\"intro-to-llms-1\"><a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#intro-to-llms-1\"></a>Intro to LLMS</h3>\n<ul>\n<li>\n<p>A LLM is just two files - a parameter file(140GB) and an executable(500 lines of code), eg: Llama-2-70B is the Lllama 2.0 model released by Meta which is trained on 70 B paramters. </p>\n</li>\n<li>\n<p>The parameteres are essentially the weights or the paramaters of this neural network that is a LLM.</p>\n</li>\n<li>\n<p>Llama is an open source; the weights, the architecture and the executable were released by Meta.</p>\n</li>\n<li>\n<p>Chat GPT never released the model architecture so you don't have access to that model.</p>\n</li>\n<li>\n<p>Model inference is when you just run the model on your macbook.</p>\n</li>\n<li>\n<p>Model training is a lot more involved.</p>\n</li>\n<li>\n<p>This LLAMA model is essentially just a next word prediction model. This might seem trivial, but being able to predic the next word(s) can be very powerful since if the objective is to be a next word predicion model, eg to be able to predict the next word about Ruth Handler, you need to parse a lot of information and you end up /learning/ a lot in the process. <em>All of this knowledge is being compressed into the weights of the neural network ??</em>. - The neural network isn't actually memorizing the data but instead storing complicated patterns and learning deeper patterns and each weight contributes to understanding multiple concepts.</p>\n</li>\n<li>\n<p>First, about \"inference\" - this just means using the trained model to generate text, as opposed to training it. When you use ChatGPT or when Claude responds to you, that's inference.</p>\n</li>\n<li>\n<p>The text generation process works like this:</p>\n<ul>\n<li>\n<p>The model looks at the input text (like your question)</p>\n</li>\n<li>\n<p>It predicts what word is most likely to come next</p>\n</li>\n<li>\n<p>It adds that word to the sequence</p>\n</li>\n<li>\n<p>Then it uses the updated sequence to predict the next word</p>\n</li>\n<li>\n<p>This process repeats until it completes the response</p>\n</li>\n<li>\n<p>The phrase \"dreams internet documents\" is a colorful way of saying that the model recreates text patterns similar to its training data (which includes many internet documents). It's not literally dreaming or remembering specific documents - instead, it has learned patterns from millions of texts and can generate new text following similar patterns.</p>\n</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"there-are-three-main-parts-of-building-a-model---training-inference-and-fine-tuning\"><a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#there-are-three-main-parts-of-building-a-model---training-inference-and-fine-tuning\"></a>There are three main parts of building a model - <strong>training</strong>, <strong>inference</strong> and <strong>fine-tuning</strong>.</h3>\n<pre><code>- Training involves firstly scraping the internet for loads of text, of the magnitude of 10TB. After scraping all of this data, the model is trained on this data and all of this data is then _compressed_ into the paramters and weights of the neural network. The LLAMA 2.0 model for instance has 70B parameters which is around 140GB of data. So you can think that the compression that takes place is some sort of lossy compression where all of the data is sort of compressed into these parameters. Training is the most expensive part of the process where a huge GPU cluster is leveraged for over 12 days(for LLAMA) and costs 2M dollars.\n\n- Inference is the most straightforward part. When interacting with a model, the model performs inference and responds to your queries.\n\n- Fine-Tuning is the step after inference where the model turns from being a next word prediction model to some sort of assistant.\n</code></pre>\n<h3 id=\"how-does-it-work\"><a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#how-does-it-work\"></a>How does it work?</h3>\n<pre><code>- We don't know really. We know in full detail what the architecture of the neural network looks like and what math is performed at each step, but we still don't know _how_ these parameters/nodes which are dispersed through the neural network interact with each other.\n\n- We know that they build some sort of knowledge base but it's a bit strange. We know that it works _emperically_, and we know how to fine-tune models and make them better based on evaluation tests.\n</code></pre>\n<h3 id=\"fine-tuning\"><a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#fine-tuning\"></a>Fine-Tuning</h3>\n<pre><code>- We first come up with the labeling instructions for the fine tuning job, and then hire people or use scale.ai to perform these labeling tasks where they maybe compile 100,000 questions and answer type forms.\n\n- These forms are very high quality.\n\n- The model is then trained on these forms(training takes approx 1 day) and it then subscribes to the structure of these forms and turns in to an assistant.\n\n- You can then run a lot of evalutaions on this assistant and go back to the first step again to imporove the model based on your evaluations.\n</code></pre>\n<h3 id=\"scaling-laws\"><a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#scaling-laws\"></a>Scaling Laws</h3>\n<pre><code>- The performance of the model is governed by N - **number of parameters in the network** and `D` - **amount of text** it's trained on.\n\n- So far, there is not upper bound on the performance so in theory we could just keep scaling.\n\n- Algorithmic improvements would be a plus but in theory we can just keep getting better with more **time** and more **compute**.\n</code></pre>\n<h3 id=\"tool-use\"><a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#tool-use\"></a>Tool use</h3>\n<pre><code>- Tool use is another reason why these LLMs are becoming so capable. Being able to use tools like browsers, calculators, graphing libraries, image generation libraries etc empowers the LLMS to perform complex tasks like humans would.\n</code></pre>\n<hr>\n<strong>Backlinks</strong>\n<ul>\n<li><a href=\"/dendron-main/notes/kndcs9cayrizdzefp1veykh\">AK</a></li>\n</ul>","noteIndex":{"id":"root","title":"root","desc":"","updated":1746040151076,"created":1595961348801,"custom":{"nav_order":0,"permalink":"/"},"fname":"root","type":"note","vault":{"fsPath":".","selfContained":true,"name":"Dendron"},"contentHash":"3338f3f44ea53fff248fd70b6ad85170","links":[],"anchors":{},"children":["oz8e6a05bjgd3cbtru3hqe2","c1bs7wsjfbhb0zipaywqv1","3x4fmd16chquma6kovvfatj","gdjyzsq56qgyj5t5uktrsgu","69h59jt3vyfdg55g7gqc95d","wz9z8az9m9aq5132p7d10co","l1lcmphk4ubvu1aiqhcs7ib","bd3mupfj68nrgnjejss1qqh","1tlnuf6o2f3qawzg799ilzk","z5mfdumpr0cv3ceh60flq8n","filwymswyiwdojrwinvy5xd"],"parent":null,"data":{},"body":"\nSiddharth's root\n\nThis vault contains all the verticals to climb."},"collectionChildren":null,"customHeadContent":null,"config":{"version":5,"dev":{"enablePreviewV2":true,"enableSelfContainedVaults":true},"commands":{"lookup":{"note":{"selectionMode":"extract","confirmVaultOnCreate":true,"vaultSelectionModeOnCreate":"smart","leaveTrace":false,"bubbleUpCreateNew":true,"fuzzThreshold":0.2}},"randomNote":{},"insertNoteLink":{"aliasMode":"none","enableMultiSelect":false},"insertNoteIndex":{"enableMarker":false},"copyNoteLink":{"aliasMode":"title"},"templateHierarchy":"template"},"workspace":{"vaults":[{"fsPath":".","selfContained":true,"name":"Dendron"}],"journal":{"dailyDomain":"daily","name":"journal","dateFormat":"y.MM.dd","addBehavior":"childOfDomain"},"scratch":{"name":"scratch","dateFormat":"y.MM.dd.HHmmss","addBehavior":"asOwnDomain"},"task":{"name":"task","dateFormat":"y.MM.dd","addBehavior":"asOwnDomain","statusSymbols":{"":" ","wip":"w","done":"x","assigned":"a","moved":"m","blocked":"b","delegated":"l","dropped":"d","pending":"y"},"taskCompleteStatus":["done","x"],"prioritySymbols":{"H":"high","M":"medium","L":"low"},"todoIntegration":false,"createTaskSelectionType":"selection2link"},"graph":{"zoomSpeed":1,"createStub":false},"enableAutoCreateOnDefinition":false,"enableXVaultWikiLink":false,"enableRemoteVaultInit":true,"enableUserTags":true,"enableHashTags":true,"workspaceVaultSyncMode":"noCommit","enableAutoFoldFrontmatter":false,"enableEditorDecorations":true,"maxPreviewsCached":10,"maxNoteLength":204800,"enableFullHierarchyNoteTitle":false,"enablePersistentHistory":false,"enableHandlebarTemplates":true,"enableSmartRefs":false},"preview":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enableFrontmatterTags":true,"enableHashesForFMTags":false,"enablePrettyRefs":true,"enableKatex":true,"automaticallyShowPreview":false,"enableMermaid":true},"publishing":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enablePrettyRefs":true,"enableKatex":true,"copyAssets":true,"siteHierarchies":["root"],"writeStubs":false,"siteRootDir":"docs","seo":{"title":"Dendron","description":"Personal Knowledge Space"},"github":{"enableEditLink":true,"editLinkText":"Edit this page on GitHub","editBranch":"main","editViewMode":"tree"},"enableSiteLastModified":true,"enableFrontmatterTags":true,"enableHashesForFMTags":false,"enableRandomlyColoredTags":true,"enableTaskNotes":true,"enablePrettyLinks":true,"searchMode":"search","siteUrl":"https://sid1081.github.io","assetsPrefix":"/dendron-main","enableMermaid":true,"siteFaviconPath":"favicon.ico","siteIndex":"root"}}},"__N_SSG":true}